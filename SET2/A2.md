# 1. Используем мастер-теорему
## (a) $T(n) = 13 \cdot T(\frac{n}{21}) + n^{1.5},$ где $ T(n)=1 $ при $ n<21$

$a = 13,\, b = 21,\, k=1.5$

$\log_{21}13 < 1.5 \implies T(n) = O(n^{1.5})$

---

## (b) $T(n) = T(n-2) + T(n-3) + n,$  где $T(1)=T(2)=T(3)=1$
Напрямую не можем использовать мастер-теорему, но можем заменить при оценке сверху $T(n-3)$ на $T(n-2)$:
$T(n) = 2 \cdot T(n-2) + n$

$a = 2,\, b = 2,\,k=1$

$a > 1\implies T(n) = O(2^{n/2} \cdot n)$

---

## (c) $T(n)=12 \cdot T(\frac{n}{4}) + n\sqrt{n \sqrt{n}},$ где $T(n) = 1$ при $n<4$

$n\sqrt{n \sqrt{n}} = n ^{1.75}$

$a=12, \, b=4, \, k = 1.75$

$\log_{4}12 > 1.75 \implies T(n) = O(n^{\log_4 12}) \approx  O(n^{1.79})$

---

## (d) $T(n) = 2 \cdot T(\frac{n}{3}) + 2 \cdot G(\frac{n}{3}) + O(1)$ 
$G(n) = 2 \cdot G(\frac{n}{3}) + n\cdot \sin n,$ где $T(n) = 1$ при $n < 3$ 

Не можем использовать мастер-теорему, потому что $\sin$ не монотонная функция и внутри $T(n)$ могут быть рекурсивные вызовы только $T(n_0), $ где $n_0 < n$

---

## (e) $T(n) = \frac{9}{4} \cdot T(\frac{2n}{3}) + n^2 \cdot \ln \sqrt n \cdot \ln \ln n,$ где $T(n) = 1$ при $n<3$
При $n \ge 3, \, \ln \sqrt n \cdot \ln \ln n$ - монотонная функция.
Тогда $a=\frac{9}{4}, \, b=\frac{3}{2}, \, k = 2$

$\log_{\frac{3}{2}} \frac{9}{4} = 2 = k \implies T(n) = O(n^2 \cdot \ln \sqrt n \cdot \ln {\ln {n}} \, \cdot \log n)$

---

# 2. Используем итерацию на (d)
Оценим $G(n) \le 2G(\frac{n}{3}) + n,$ т.к. $|\sin n |\le 1$

$$G(n) \le 2G(\frac{n}{3}) + n = 4G(\frac{n}{9}) + \frac{2}{3}n + n = 4G(\frac{n}{9}) + \frac{5}{3}n$$

Продолжая k шагов, получаем:

$$G(n) \le 2^k \cdot G(\frac{n}{3^k}) + n \sum_{i=0}^{k-1}(\frac{2}{3})^i$$

$k = \log_3n$ (глубина рекурсии)

$$G(n) \le 2^{\log_3n} \cdot O(1) + n \sum_{i=0}^{log_3{n} -1}(\frac{2}{3})^i \le 2^{\log_3n} \cdot O(1) + 3n$$

Тогда $G(n) = O(n)$

$$T(n) \le 2T(\frac{n}{3}) + O(n)$$

Тогда по мастер-теореме:
$$T(n) = O(n)$$

# 3. Используем мастер-теорему и метод Акра-Баззи
## (a) $T(n) = T(\frac{n}{4}) + 2 \cdot T(\frac{n}{16}) + n \cdot \log_2n,$ где $T(n) = 1$ при $n < 16$

Заменим $T(\frac{n}{16})$ на $T(\frac{n}{4})$: $T(n) = 3 \cdot T(\frac{n}{4}) + n \cdot \log_2n,$

По мастер-теореме: $T(n) = O(n \log n)$

---

Найдем p, для которого выполняется $(\frac{1}{4})^p + 2 \cdot (\frac{1}{16})^p = 1$

$p=\frac{1}{2}:$

$$T(n) = \Theta(n^\frac{1}{2} \cdot (1 +\int_{16}^n \frac{u \cdot \log_2 u}{u^{1.5}}du)) = \Theta(n^\frac{1}{2} \cdot \sqrt n \cdot \ln n)) = \Theta(n \log n)$$


---


## (b) $T(n) = 3 \cdot T(\frac{n}{2}) + 6 \cdot T(\frac{n}{5}) + T(\frac{n}{10}) + \frac{n^2}{\ln n},$ где $T(n) = 1$ при $n < 10$

$\frac{n^2} {\ln n}$ - монотонная функция, при $n \ge 10$.

Заменим $T(\frac{n}{10})$ и $T(\frac{n}{5})$ на $T(\frac{n}{2})$:

$$T(n) = 10 \cdot T(\frac{n}{2}) + \frac{n^2}{\ln n}$$

По мастер-теореме: $T(n) = O(n^{\log_2 10}) \approx O(n^{3.32})$

---

Найдем p, для которого выполняется $3 \cdot (\frac{1}{2})^p + 6 \cdot (\frac{1}{5})^p + (\frac{1}{10})^p = 1$

$p=2:$

$$T(n) = \Theta(n^2\cdot (1 +\int_{10}^n \frac{u^2}{\ln u \cdot u ^3}du)) = \Theta(n^2 \cdot \ln |\ln u| |^n_{10}) = \Theta(n^2 \cdot \log \log n)$$


---

В (a) результаты совпали, потому что наибольший вклад вносит нерекурсивная работа $n \log n$.

В (b) результаты отличаются, потому что наибольший вклад вносит рекурсивная работа, а для использования мастер-теоремы мы её грубо оценили сверху.

---