# 1. Дерево рекурсии

$$T(n) = \begin{cases}
   2 \cdot T(\frac{n}{2}) + n, & \text{если n четно}
\\ 2 \cdot T(n-1) + n, & \text{если n нечетно}
\\ T(1) = 1
\end{cases}$$

Дерево нетривиально, но можем заметить, что в любом случае есть 2 рекурсивных вызова.
Тогда каждый следующий уровень будет иметь в 2 раза больше узлов.
Также можно заметить, что при нечетном случае вызывает T(n-1), т.е. следующий вызов будет четным.


Рассмотрим на примере n = 6:
```
                n
         /             \
      n/2              n/2
     /   \            /   \
  n/2-1  n/2-1     n/2-1  n/2-1
   / \     / \      / \     / \
 n=1 n=1 n=1 n=1  n=1 n=1 n=1 n=1
```
---

# 2. Оценка сложности
Т.к. оцениваем верхнюю границу, то возьмем худший случай для n.
Легко понять, что это n вида *1111111...* в двоичном представлении или $n = 2^m-1$. Уровни дерева в этом случае будут чередоваться:
n-1, n/2, n-1, n/2...


1. Глубина дерева $2 \cdot \log_2n$

2. $N_{k \, уровень} = 2^k$

Будем рассматривать уровни парами. Т.к. оцениваем сверху, то можем оценить работу на узел как:

3. Работа на узел $\frac{n}{2^{k/2}} \le 2^{m-k/2}$

Тогда работа на уровне:

$k = 2i: 2^{2i} \cdot 2^{m-i} = 2^{m + i}$

$k = 2i+1: 2^{2i+1} \cdot 2^{m-i} = 2^{m+i+1}$  

Работа на паре уровней:

4. $2^{m+i} + 2^{m+i+1} = 3 \cdot 2^{m+i}$ 


5. $T(n) \le \sum_{i=0}^{m-1} 3 \cdot 2^{m+i} = 3 (n+1) n = O(n^2)$

